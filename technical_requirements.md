Визуальное представление технического задания на Miro: https://miro.com/app/board/uXjVPtNmbTI=/

# 1. Цель проекта
Цель проекта — приложения для поддержки иностранных Студентов, пребывающих на территорию РФ для получения образования (далее Приложение). Приложение помогает во взаимодействии иностранных Студентов и их сопровождающих.  Также в приложении Студенты в доступном и понятном виде, на их языке, могут просмотреть и прочитать информацию, необходимую для первичной адаптации на территории России.


# 2. Описание системы
Структура системы состоит из следующих основных блоков:
1. Типы пользователей
2. Процесс регистрации, авторизации и аутентификации
3. Экраны и функционал для Иностранного Студента (ИС)
4. Экраны и функционал для Сопровождающего

## 2.1. Типы пользователей
Система предусматривает два три пользователей Системы: Иностранный Студент (ИС, Студент) и Сопровождающий.

* Иностранный Студент с помощью приложения записывается на приезд, имеет чек-лист необходимых мероприятий и инстанций, которые нужно пройти, а также имеет информационный справочник с полезной информацией для первичной адаптации на территории России.
* Сопровождающий с помощью приложения может выбрать для себя приезд, который хочет сопровождать. По каждому приезду имеет чек-лист необходимых мероприятий и инстанций, которые нужно пройти вместе с ИС.
* Тимлидер является менеджером по взаимодействию Сопровождающего и ИС. Имеет возможность убирать Сопровождающих из приезда (при конфликтных ситуациях), подтверждать статус профиля Сопровождающего, а также отвечать на вопросы ИС в поддержке.

## 2.2. Процесс регистрации, авторизации и аутентификации 
Регистрация всех типов пользователей осуществляется в приложении. По умолчанию регистрация происходит для ИС. Для Сопровождающих и Тимлидеров имеется возможность зарегистрироваться как Сопровождающий. Тимлидеры регистрируются как Сопровождающие, затем тип их профиля меняется вручную администратором.

### 2.2.1. Загрузочный экран
После открытия приложения пользователь сперва попадает на загрузочный экран с заставкой (анимацией). Анимация и загрузка приложения должна длиться не более 2-3 секунд.

Далее происходит 2 сценария:
1. Если пользователь уже вошел в аккаунт, то происходит 2.2.7. "Распределение по экранам".
2. Если пользователь еще не вошел в аккаунт, то открывается 2.2.2. "Приветственный экран".

### 2.2.1. Выбор языка
Пользователю предлагается язык на выбор. Изначально весь текст в приложении отображается на русском языке и выбран русский язык. Если пользователь желает сменить язык, он выбирает нужный.

На экране отображается 1 кнопка:
1. Кнопка "Далее" — применяет выбор языка, открывает экран 2.2.2. "Приветственный экран".

### 2.2.2. Приветственный экран
Экран содержит несколько слайдов с презентацией приложения. Переход вперед-назад осуществляется свайпами. Отображаются page controls. При переходе на последний слайд отображается (и не пропадает при переходе обратно) кнопка "Зарегистрироваться":
1. Кнопка "Зарегистрироваться" — открывает экран 2.2.3. "Регистрация ИС".

### 2.2.3. Регистрация ИС
По умолчанию регистрация происходит для ИС. Экран содержит следующие поля для заполнения:
1. Университет — университет, в котором будет обучаться ИС на территории России. Поле представляет собой выпадающий список с вузами, в которых доступен сервис. Выбранное значение после окончания этапа регистрации заполняет поле 8. "Университет" в профиле ИС.
2. Email — введенное значение после окончания этапа регистрации заполняет поле 5.2. "Email" в профиле ИС.
3. Пароль
4. Подтверждение пароля

Также экран содержит следующую информацию:
5. информация о требованиях к паролю
6. Надпись: "Регистрируясь в приложении, вы даете свое согласие с Пользовательским Соглашением и Политикой Конфиденциальности", где слова "Пользовательским Соглашением" и "Политикой Конфиденциальности" являются гиперссылками и ведут на соответствующие страницы сайта проекта.

На экране отображаются 3 кнопки — "Зарегистрироваться", "Я Сопровождающий" и "Войти":
1. Кнопка "Зарегистрироваться" — по нажатии на кнопку происходит:
   1. проверка пароля в поле 3 на соответствие требованиям. Если пароль не соответствует требованиям к паролю, поле 3 подсвечивается красным по контуру, появляется надпись: "Пароль не соответствует требованиям".
   2. проверка полей 3 и 4 на совпадение. Если пароли не совпадают, то поля 3 и 4 подсвечиваются красным по контуру, появляется надпись: "Пароли не совпадают".
   3. проверка валидности адреса электронной почты. Если почта не соответствует формату, то поле 2подсвечивается красным по контуру, появляется надпись: "Почта не соответствует формату".

      Если же почта валидна и пароли совпадают, то открывается экран 2.2.4. "Подтверждение почты". 

2. Кнопка "Я Сопровождающий" — открывает экран 2.2.6. "Регистрация Сопровождающего".
3. Кнопка "Войти" — открывает экран 2.2.5. "Вход"

### 2.2.4. Подтверждение почты
По открытии экрана на почту, введенную пользователем, автоматически отправляется письмо с кодом подтверждения. 

Экран содержит следующую информацию:
1. надпись: "Мы отправили код подтверждения на вашу почту".
2. надпись ниже первой: "Введите код в поле ниже: "

Экран содержит следующие поля для заполнения:
1. "Код подтверждения" — поле для 4 цифр. По нажатии на поле клавиатура переключается в режим ввода цифр.

На экране отображаются 2 кнопки — "Не получили письмо?" и "Далее":
1. Кнопка "Не получили письмо?" — открывает всплывающее окно с надписью: "Не получили письмо?" Во всплывающем окне содержатся 2 кнопки — "Отправить код еще раз" и "Связаться с поддержкой":
   1. Кнопка "Отправить код еще раз" — отправляет письмо с новым кодом подтверждения на почту пользователя. Возможность переотправить код доступна раз в 60 секунд. Закрывает всплывающее окно.
   2. Кнопка "Связаться с поддержкой" — открывает экран поддержки в приложении / открывает экран с контактами поддержки / открывает страницу с контактами поддержки на сайте проекта / открывает диалоговое окно с поддержкой в приложении. Закрывает всплывающее окно.
2. Кнопка "Далее" — проверяет введенный пользователем код на соответствие отправленному на почту. Если код неверный, то поле 1 подсвечивается красным по контуру, появляется надпись: "Код неверный". Если же код 
   верный, то:
   1. введенные данные отправляются в базу данных
   2. пользователь автоматически авторизуется в систему под 
      введенными данными
   3. Если почта подтверждается для завершения процесса регистрации, то происходит 2.2.7. "Распределение по 
      экранам". Если же пользователь подтверждает почту для сброса пароля, то открывается экран 2.2.9. 
      "Установка нового пароля".

### 2.2.5. Вход
На этом экране осуществляется вход для уже зарегистрированных пользователей: ИС и Сопровождающих.
Экран содержит следующие поля для заполнения:
1. Email
2. Пароль

На экране отображаются 2 кнопки — "Войти" и "Забыли пароль?":
1. Кнопка "Войти" — проверяет введенные пользователем данные в полях 1 и 2 на соответствие существующим в 
   БД. Если данные верны, то открывает 2.2.7. "Экран распределения". Если же данные одного из полей неверны, то 
   подсвечиваются красным по контуру поля 1 и 2, появляется надпись: "Почта или пароль введены неверно".
2. Кнопка "Забыли пароль?" — открывает 2.2.8. "Экран восстановления пароля"

### 2.2.6. Регистрация Сопровождающего
Экран содержит следующие поля для заполнения:
1. Университет — университет, в котором обучается Сопровождающий. Выпадающий список с вузами, в которых доступен 
   сервис. Данные заносятся в поле 1 "Университет" профиля Сопровождающего. 
2. Email
3. Пароль 
4. Подтверждение пароля 

На экране отображается 1 кнопка — "Зарегистрироваться":
1. Кнопка "Зарегистрироваться" — работа этой кнопки аналогична работе кнопки "Зарегистрироваться" на экране 2.2.3. "Регистрация ИС".

### 2.2.7. Распределение по экранам
В зависимости от типа пользователя происходят разные сценарии:
1. Тип пользователя "ИС" — по умолчанию открывает экран 2.3.2. "Список задач".
2. Тип пользователя "Сопровождающий" — по умолчанию открывается экран 2.4.2. "Список задач"
3. Тип пользователя "Тимлидер" — по умолчанию открывается экран 2.4.3. "Все приезды"

### 2.2.8. Экран восстановления пароля
Экран содержит следующие поля для заполнения:
1. Email 

На экране отображается 1 кнопка — "Далее":
1. Кнопка "Далее" — проверяет БД на наличие аккаунта с таким адресом электронной почты. Если такой аккаунт 
   существует, открывает экран 2.2.4. "Подтверждение почты". Если аккаунт с такой почтой не был найден в БД, 
   поле 1 подсвечивается красным, отображается надпись: "Пожалуйста, введите верный адрес."

### 2.2.9. Установка нового пароля
Экран содержит следующие поля для заполнения:
1. Новый пароль
2. Подтверждение нового пароля

На экране отображается 1 кнопка — "Готово":
1. Кнопка "Готово" — делает следующее:
   1. проверяет поле 1 на соответствие требованиям к паролю. Если пароль не соответствует требованиям к 
      паролю, поле 1 подсвечивается красным по контуру, появляется надпись: "Пароль не соответствует требованиям".
   2. проверяет поля 1 и 2 на совпадение. Если пароли не совпадают, 
      то поля 1 и 2 подсвечиваются красным по контуру, появляется надпись: "Пароли не совпадают". Если пароли 
      совпадают, то заменяет пароль для этого пользователя на Новый пароль в БД.
   3. открывает экран 2.2.5. "Вход".

## 2.3. Экраны и функционал для Иностранного Студента (ИС)

ИС после аутентификации (ввода логина и пароля) получает доступ к 
своему функционалу в системе. Этот функционал состоит из
следующих экранов:

1. Профиль
2. Список задач
3. Маршрут
4. Информационный справочник
5. Мессенджер

### 2.3.1. Профиль

В этом разделе у ИС есть возможность редактирования некоторых данных
своего профиля. Профиль содержит следующие поля:

0. Фото — круглая область с фотографией, по умолчанию стоит заглушка. При тапе на область открывается системный 
   файлпикер, загружается изображение, обрезается до формата 1x1, вписывается в круг.
1. Полное имя
2. Гражданство — bottomsheet, открывающийся поверх текущего экрана с названиями всех стран, их 
   флагами и поиском нужной страны среди всех. В топе списка находятся 3 самых популярных страны.
3. Пол — выпадающий список с выбором "Мужской" / "Женский".
4. Дата рождения — справа от даты прозрачными цифрами отображается число полных лет ИС.
5. Контакты:
   1. Телефон — В начале поля стоит полупрозрачный "+" в виде 
       плейсхолдера. Само поле имеет формат цифр. Длина до 12 
       символов.
   2. Email — Значение заполняется при регистрации аккаунта.
   3. Telegram — В начале поля стоит полупрозрачный "@" в виде 
       плейсхолдера. Поле имеет текстовый формат. Только латиница. Длина до 32 символов.
   4. WhatsApp — В начале поля стоит полупрозрачный "+" в виде плейсхолдера. 
       Само поле имеет формат цифр. Длина до 12 символов.
   5. VK — В начале поля стоит полупрозрачный "@" в виде плейсхолдера. Поле 
       имеет текстовый формат. Только латиница. Длина до 32 символов.
6. Родной язык — bottomsheet, открывающийся поверх текущего экрана 
   со всеми языками и поиском нужно языка среди всех. В топе находятся 3 
   самых популярных языка.
7. Другие языки и уровень владения ими — аналогично полю 6.
   "Родной язык". После выбора языка из перечня пользователь также выбирает уровень владения 
   языком по классификации CERF.
8. Университет — университет, в котором будет обучаться ИС в России.
9. Статус оплаты сопровождения — это поле отображается, если 
    ИС выбрал организацию сопровождения PRIVET. Содержит 
    значения "Да" и "Нет" соответственно если услуги оплачены 
    и не оплачены.
10. Тип профиля — Имеет значения Студент, Сопровождающий и Тимлидер. Для ИС выбирается статус "Студент" по 
    умолчанию при регистрации. Может быть изменено на "Сопровождающий".
11. Последний сопровождающий — заполняется автоматически, когда Сопровождающий выбирает приезд, в котором есть этот 
    ИС. Информация берется из поля Полное имя профиля Сопровождающего.
12. Институт — выпадающий список со всеми институтами УрФУ (сортированный по количеству обучающихся там ИС) + 
    "Подготовительный факультет". Поле не отображается, если ИС обучается не в УрФУ.
13. Направление обучения — текстовое поле.
14. Дата последнего приезда — берется из поля "Дата приезда" последнего приезда, к которому относится Студент. 
    Для некоторых исключительных случаев разрешено изменение этого поля Сопровождающим, который относится к 
    последнему приезду этого Студента.
15. Дата окончания последней визы
16. Место проживания — текстовое поле.
17. Комментарий от сопровождающего — текстовое поле.

* ИС имеет возможность редактировать следующие поля: 0-5.1, 5.3-8.
* Сопровождающий, при условии что он является последним Cопровождающим, имеет возможность редактировать следующие поля в 
профиле ИС: 14-19.
* Тимлидер имеет возможность редактировать поле 10 "Тип профиля". Если ИС спустя какое-то время захочет стать 
  сопровождающим и пройдет собеседование с Тимлидером, Тимлидер может изменить тип профиля со Студент на Сопровождающий.

Поля 11-17 являются частью расширенного профиля Студента, видимого только Сопровождающими и 
Тимлидерами. 

На экране отображается 2 кнопки — "Настройки" и "Уведомления":
1. Кнопка "Открыть настройки приложения" — открывает экран 2.3.8. "Настройки".
2. Кнопка "Уведомления" — открывает экран 2.3.1.2 "Уведомления".

#### 2.3.1.1. Настройки
Экран 2.3.1.1. "Настройки" является общим для всех типов пользователей. 

На экране отображаются 3 кнопки — "Выход из аккаунта", "Сменить язык", "Уведомления":
1. Кнопка "Выход из аккаунта" — разлогинивает пользователя из текущего аккаунта. Открывает экран 2.2.3. 
   "Регистрация ИС" или экран 2.2.6. "Регистрация Сопровождающего", если пользователь 
   является ИС или Сопровождающим соответственно.
2. Кнопка "Сменить язык" — изначально весь текст в приложении отображается на английском языке. Если 
   пользователь желает сменить язык, он нажимает на кнопку и в выпадающем списке из доступных языков выбирает 
   нужный. Язык приложения изменяется сразу. Если изменить язык приложения сразу невозможно, то приложение 
   перезапускается и язык меняется.

##### 2.3.1.2. Уведомления
На этом экране пользователю отображаются все уведомления, которые присылало ему приложение с помощью системных 
уведомлений. Он может открыть этот экран, для того чтобы прочитать и отметить прочитанным уведомление.

### 2.3.2. Список задач

Если ИС еще не отправил информацию о своем приезде, то отображается только 1 кнопка "Зарегистрировать приезд". По 
нажатии на кнопку происходит два сценария:
1. Если ИС выбрал организацию PRIVET и уже оплатил услуги — открывается экран 2.3.2.2. "Регистрация приезда".
2. Если ИС выбрал организацию PRIVET и еще не оплатил услуги — открывается экран 2.3.2.1. "Оплата".

По умолчанию и, если ИС уже отправил приезд, отображается список мероприятий и инстанций, которые нужно пройти ИС в определенные даты (в виде списка).

Инстанции отсортированы по дате (от ближайших к более поздним) и имеют чекбокс со статусом выполнения (галочка 
/ отсутствие галочки). Пройденные инстанции становятся полупрозрачными, название зачеркивается, вкладка 
перемещается вниз.

Наверху отображается Progress Bar с прогрессом по пройденным инстанциям.

Для каждого ИС экран "Список задач" следующие вкладки:
1. Встреча в аэропорту — дедлайн: "Дата приезда" ИС (берется из приезда)
2. Оплата и заселение в хостел
3. Обмен денег
4. Оформление сим-карты
5. Прохождение медосмотра
6. Перевод паспорта с нотариальным заверением
7. Оформление банковской карты
8. Оформление документов о зачислении
9. Оформление страховки
10. Оформление документов на общежитие
11. Оформление пропуска / студенческого билета
12. Прохождение медосвидетельствования — дедлайн: дата дедлайна для "Продление визы" (поле 13) минус 3 дня. Между 
    датой дедлайна "Прохождение медосвидетельствования" и датой дедлайна "Продление визы" должно быть не менее 
    3 рабочих 
    дней.
13. Продление визы — дедлайн: "Дата окончания последней визы" из профиля ИС минус 40 дней. Если дедлайн 
    выпадает на выходной день или праздник, то дата дедлайна уменьшается до ближайшего рабочего дня. "Дата окончания визы" устанавливается 
    Сопровождающим вручную в расширенном профиле Студента.
14. Прохождение дактилоскопии — дедлайн: "Дата последнего приезда" из профиля ИС плюс 3 месяца.

За 3 дня до наступления дедлайна задач 12-14 ИС приходит уведомление с соответствующим напоминанием.

Поля "Прохождение медосвидетельствования", "Продление визы", "Прохождение дактилоскопии" 
не имеют дедлайна, если соответственно в полях "Продление визы, "Дата окончания последней 
визы", "Дата последнего приезда" не содержится даты, необходимой для вычисления даты для этого поля.

#### 2.3.2.1. Оплата
дополнить !!

#### 2.3.2.2. Регистрация приезда

Экран представляет собой форму с данными об участниках приезда, которую заполняет 
организатор. Форма имеет следующие поля:
1. Полное имя
2. Пол — выпадающий список с выбором "Мужской" / "Женский".
3. Дата приезда — открывается системный Date Picker.
4. Время приезда — открывается системный Time Picker.
5. Номер рейса — текстовое поле.
6. Пункт прибытия — выпадающее меню с выбором: Ж/Д вокзал / Аэропорт 
7. Гражданство ИС — bottomsheet, открывающийся поверх текущего экрана 
   с названиями всех стран, их флагами и поиском нужной страны среди 
   всех. В топе списка находятся 3 самых популярных страны.
8. Контакты:
   1. Телефон — В начале поля стоит полупрозрачный "+" в виде 
       плейсхолдера. Само поле имеет формат цифр. Длина до 12 
       символов.
   2. Telegram — В начале поля стоит полупрозрачный "@" в виде 
       плейсхолдера. Поле имеет текстовый формат. Только латиница. Длина до 32 символов.
   3. WhatsApp — В начале поля стоит полупрозрачный "+" в виде плейсхолдера. 
       Само поле имеет формат цифр. Длина до 12 символов.
   4. VK — В начале поля стоит полупрозрачный "@" в виде плейсхолдера. Поле 
       имеет текстовый формат. Только латиница. Длина до 32 символов.
9. Комментарий — текстовое поле.
10. Билеты — не имеет никаких вводимых данных. Рядом с ним отображаются загруженные файлы, которые ИС загрузил 
    как билеты (отображаются обложки файлов) кнопкой "Загрузить билеты".

Примечание: поля "Полное имя", "Пол", "Гражданство", а также все подполя поля "Контактов" связаны с идентичными 
полями в профиле Студента. Это означает, что если эти поля были заполнены ранее в профиле (на экране 2.3.1. 
"Профиль"), то на экране 2.3.2.2. "Регистрация приезда" они автоматически заполняются теми же значениями. 
Если все или какие-то из полей не были заполнены в профиле, то при заполнении полей на экране "Регистрация 
приезда" данные из этих полей заполняют соответствующие поля в профиле ИС. 

Внизу экрана отображаются 3 кнопки — "Добавить больше участников приезда", "Отправить информацию о приезде" и "Загрузить билеты":

1. Кнопка "Добавить больше участников приезда" — _либо удлиняет экран "Регистрация приезда" на такое же 
   количество полей, сколько на нем есть (чтобы все участники приезда отображались на длинном скролящимся 
   экране), либо открывается дополнительный экран для каждого нового участника приезда (между которыми возможно 
   переключение), также имеющий аналогичные поля_. Добавлением участников приезда занимается Студент-организатор,
   который сам участвует в приезде. В приезде могут участвовать только ИС, которые зарегистрированы в системе и 
   оплатили услуги сопровождения. Добавление участника в приезд возможно только при наличии его в системе и при 
   условии, что он оплатил услуги. В противном случае поля будут недоступны для редактирования. Добавление 
   осуществляется по полному имени ИС. На данном этапе может произойти несколько сценариев развития событий:
   1. Полное имя введено верно, Студент есть в системе и услуги оплачены. Поля становятся доступными 
      для редактирования, на экране отображается надпись: "Студент есть в системе. Услуги сопровождения оплачены."
   2. Полное имя введено верно, Студент есть в системе, но не оплатил услуги сопровождения. На экране отображается 
      надпись "Студент есть в системе. Услуги сопровождения не оплачены".
   3. Полное имя введено неверно или Студента нет в системе. На экране отображается надпись "Мы не нашли 
      Студента в системе. Пожалуйста, попросите Студента зарегистрироваться или проверьте правильность написания 
      полного имени."

2. Кнопка "Отправить информацию о приезде" — при добавлении новых участников приезда (и если будет выбран 
   вариант с несколькими экранами для каждого отдельного ИС) переносится на последний экран. После нажатия этой 
   кнопки:
   1. приезду добавляется поле "Номер приезда" с его уникальным 3-значным 
      номером.
   2. соответствующий приезд отображается в разделе "Все приезды" у Сопровождающих. Данные полей 
      экрана "Регистрация приезда" переносятся в данные полей "Приезд" экрана у Сопровождающего.
   3. открывается экран 2.3.2.3 "Приезд отправлен".

3. Кнопка "Загрузить билеты" — открывает системный file picker, из которого можно загрузить до 10 файлов любого 
   типа. После загрузки файлов снова открывается экран 2.3.2.2. "Регистрация приезда", доступный к заполнению и 
   изменению.

##### 2.3.2.3 Приезд отправлен
Экран содержит следующие надписи: "Ваш приезд был передан вашей сопровождающей организации, спасибо!", 
"Информациия о приезде будет отображаться в разделе "Список задач", "Вы также можете сообщить нам 
дополнительную информацию о вас в вашем профиле".

На экране отображаются 2 кнопки — "Указать дополнительную информацию" и "Перейти к списку задач":
1. Кнопка "Указать дополнительную информацию" — открывает экран 2.3.1. "Профиль"
2. Кнопка "Перейти к списку задач" — открывает экран 2.3.2. "Список задач"

### 2.3.3. Маршрут
Условия для экранов "Маршрут" и "Информационный справочник":
Примечание: в зависимости от условий эти экраны отображаются Студентам в ограниченном или полном доступе. Ниже 
описание условий, возможных сценариев, экранов с ограниченным доступом и экранов с полным доступом.

При переходе на экран "Маршрут" или "Информационный справочник" происходят следующие сценарии:
1. ИС выбрал организацию PRIVET, но еще не оплатил сопровождение (поле 9. "Статус оплаты сопровождения" в профиле ИС имеет значение "Нет"), то ИС имеет ограниченный доступ на этом экране.
2. Если ИС выбрал организацию PRIVET и оплатил сопровождение, то ИС имеет полный доступ на этом экране.

При ограниченном доступе имеется следующий сценарий:
При попытке открыть другие вкладки, помимо 2 доступных, на экране отображается заглушка с надписью "Это 
содержимое доступно только для Студентов, которые выбрали сопровождающую организацию PRIVET и оплатили услуги 
сопровождения." На этом этапе, если:
1. Студент выбрал PRIVET, то для него отображается кнопка: "Оплатить услуги сопровождения", которая открывает экран 2.3.2.1. "Оплата".

Доступные к открытию вкладки при ограниченном доступе:
1. Встреча в аэропорту
2. Прохождение медосмотра

Экран содержит визуальное представление мероприятий и инстанций, которые нужно пройти каждому иностранному 
Студенту по прибытию в Россию, без определенных дат. Каждое мероприятие или инстанция сопровождаются описанием. 
Указываются денежные траты, которые влечет за собой прохождение инстанции.

Представление содержит следующие точки маршрута:
1. Встреча в аэропорту
2. Оплата и заселение в хостел
3. Прохождение медосмотра
4. Оформление сим-карты
5. Обмен денег
6. Перевод и нотариальное заверение паспорта
7. Оформление банковской карты
8. Оформление документов о зачислении
9. Оформление страховки
10. Оформление документов на общежитие
11. Оформление пропуска / студенческого билета
12. Прохождение медосвидетельствования
13. Продление визы
14. Прохождение дактилоскопии

### 2.3.4. Информационный справочник
см. "Условия для экранов "Маршрут" и "Информационный справочник" на экране 2.3.3. "Маршрут"

Экран содержит полезную справочную информацию для ИС, размещенную во вкладках.

Для каждого ИС экран "Информационный справочник" имеет одинаковые вкладки:
1. Визовый режим
2. COVID-ограничения
3. Правила поселения в общежитие
4. Правила пребывания в стране
5. Карта мест первой и второй необходимости (магазин продуктовый, магазины одежды, заведения-кафе, парикмахерские и тд)
6. Карта достопримечательностей
7. История города
8. ...

Доступные к открытию вкладки при ограниченном доступе:
1. Визовый режим
2. COVID-ограничения

При изменениях визового режима, COVID-ограничений, правил пребывания в стране и прочих важных изменениях, ИС 
приходит уведомление об этих изменениях.

### 2.3.5. Мессенджер
Экран 2.3.5. "Мессенджер" является общим для всех типов пользователей.

На этом экране ИС, Сопровождающие и Тимлидеры могут обмениваться сообщениями.

Как происходит обмен сообщениями:
* Пользователь может отправлять сообщения только тем пользователям, с которыми у него имеется диалоговое окно.
* Пользователь может отправлять текстовые сообщения и изображения.
* Диалоговые окна автоматически открываются после утверждения приезда. 
  * ИС и Сопровождающие не могут открывать новые 
  диалоговые окна. 
  * Тимлидеры могут открывать диалоговые окна как с другими Сопровождающими, так и с другими ИС, 
    которым они ещё не отправляли сообщения.
* Переписка с каждым пользователем находится в отдельной вкладке.

Отображаемые поля вкладки "Собеседник":
0. Фото собеседника
1. Полное имя собеседника
2. Предпросмотр последнего сообщения — отображает некоторое количество символов из последнего сообщения, либо 
   значок изображения, если последним сообщением является изображение.

* Тап по полю 0 открывает профиль собеседника. Исключение: пользователь "Поддержка".
* Тап по полям 1-2 открывает экран 2.3.5.1. "Диалог".

Если пользователь является Студентом или Тимлидером, на экране отображается 1 кнопка — "Поддержка". ИС пишут в 
поддержку, чтобы получить помощь от Тимлидеров. Тимлидеры же отвечают в поддержке на вопросы ИС.
1. Кнопка "Поддержка":
   1. для ИС открывает диалоговое окно с поддержкой — открывает экран 2.3.5.1. "Диалог" с пользователем 
      "Поддержка".
   2. для Тимлидеров открывает экран 2.3.5. "Мессенджер" от лица пользователя "Поддержка". Тимлидер может 
      открывать вкладки с собеседниками, читать сообщения и отвечать им от имени этого пользователя.

Описание пользователя "Поддержка" для полей вкладки "Собеседник" экрана 2.3.5. Мессенджер:
0. Фото — ![img.png](img.png)
1. Полное имя собеседника — "Поддержка"

#### 2.3.5.1. Диалог
Отображаемые поля на экране:
0. Фото собеседника
1. Полное имя собеседника
2. Поле для ввода текста

Тап по полям 0-1 открывает профиль собеседника. Исключение: пользователь "Поддержка".

На экране отображаются 2 кнопки — "Приложить изображение" и "Отправить сообщение":
1. Кнопка "Приложить изображение" — открывает галерею. Приложить можно только файлы формата изображения. После 
   приложения изображения поле 2 заполняется названием изображения и становится недоступным для 
   редактирования.
2. Кнопка "Отправить сообщение" — отправляет введенный текст или приложенное изображение собеседнику. 
   Изображения и текст отправляются раздельно.

## 2.4. Экраны и функционал для Сопровождающего (Сопровождающего, Бадди)
Сопровождающий после аутентификации получает доступ к своему функционалу в системе. Этот функционал состоит из
следующих экранов:

1. Профиль
2. Список задач
3. Все приезды
4. Студенты Сопровождающего
5. Мессенджер

Если статус аккаунта Сопровождающего является не подтвержденным (поле 9 в профиле Сопровождающего), то на 
всех экранах, кроме профиля отображается заглушка с надписью: "**Your account is not verified yet. Please, ask 
your teamleader to verify your account.**"

Если аккаунт статус Сопровождающего подтвержден, экраны отображаются по умолчанию.

### 2.4.1. Профиль
В этом разделе у Сопровождающего есть возможность редактирования некоторых данных своего профиля. Профиль содержит 
следующие поля:

0. Фото — круглая область с фотографией, по умолчанию стоит заглушка. При тапе на область открывается системный 
   файлпикер, загружается изображение, обрезается до формата 1x1, вписывается в круг.
1. Университет — университет, в котором в данный момент обучается Сопровождающий.
2. Город — город, в котором обучается и проживает Сопровождающий.
3. Полное имя
4. Дата рождения — справа от даты прозрачными цифрами отображается число полных лет Сопровождающего.
5. Контакты:
   1. Телефон — В начале поля стоит полупрозрачный "+" в виде 
       плейсхолдера. Само поле имеет формат цифр. Длина до 12 
       символов.
   2. Email — Значение заполняется при регистрации аккаунта.
   3. Telegram — В начале поля стоит полупрозрачный "@" в виде 
       плейсхолдера. Поле имеет текстовый формат. Только латиница. Длина до 32 символов.
   4. WhatsApp — В начале поля стоит полупрозрачный "+" в виде плейсхолдера. 
       Само поле имеет формат цифр. Длина до 12 символов.
   5. VK — В начале поля стоит полупрозрачный "@" в виде плейсхолдера. Поле 
       имеет текстовый формат. Только латиница. Длина до 32 символов.
6. Родной язык — bottomsheet, открывающийся поверх текущего экрана 
   со всеми языками и поиском нужно языка среди всех. В топе находятся 3 
   самых популярных языка.
7. Другие языки и уровень владения ими — аналогично полю 6.
   Родной язык. После выбора языка из перечня пользователь также выбирает уровнень владения 
   языком по классификации CERF.
8. Тип профиля — имеет значения "Студент", "Сопровождающий" и "Тимлидер". Для Сопровождающего выбирается статус 
   "Сопровождающий" по умолчанию при регистрации. Может быть изменено администратором на "Тимлидер". 
9. Статус аккаунта Сопровождающего — поле, отображающее статус подтверждения аккаунта Сопровождающего. Новый 
    пользователь может зарегистрироваться как Сопровождающий, но весь доступ к полному функционалу он 
    будет иметь только после подтверждения его статуса Сопровождающего. Подтверждением 
    занимается Тимлидер. Поле отображает два статуса аккаунта: "Подтвержден" / "Не подтвержден". Любой Тимлидер 
    может подтвердить статус аккаунта любого Сопровождающего. После подтверждения статуса Тимлидером Сопровождающий 
    становится частью команды Тимлидера.

Все поля, кроме 8-9, должны быть заполнены. Поле 9 может быть изменено тимлидером.

### 2.4.2. Список задач
Содержит список мероприятий и инстанций, которые нужно пройти Сопровождающему по определенным приездам.

По определенным приездам означает, что список задач относится НЕ к определенному Студенту, а к определенному 
приезду. В приезде может быть как один Студент, так и несколько. В таком случае нет необходимости дублировать 
задачи (н-р "Встреча в аэропорту") для каждого из Студентов группы, если задача выполняется для всех них сразу.

Инстанции (1-14) сгруппированы по приездам. Внутри группы сортированы по такому же порядку, что и поля в схеме. 
Группа имеет название, соответствующее номеру приезда. Имеют чекбокс со статусом выполнения (пройдено / не 
пройдено, просто галочка). Пройденные инстанции становятся полупрозрачными, название зачеркивается, вкладка 
перемещается вниз группы (группы вкладок инстанций определенного приезда).

Рядом с названием группы отображается небольшой Progress Bar с прогрессом по пройденным инстанциям.

Если Сопровождающий ещё не заполнил поля Last Arrival Date и Last Visa Expiration на экране Buddy's 
Students в расширенном профиле Студента для каждого Иностранного Студента, входящего в его приезды, то в топе отображается 
кнопка "Заполнить информацию о [Полное Имя Студента]" с приглашением заполнить информацию для каждого Студента группы. Для каждого Студента группы 
(приезда) отдельная кнопка. Кнопки сгруппированы по номеру приезда. 
На экране отображается кнопка — "Заполнить информацию о [Полное Имя Студента]":
1. Кнопка "Заполнить информацию о [Полное Имя Студента]" — открывает профиль Студента, который является 
   расширенным для Сопровождающего. Сопровождающему необходимо обязательно заполнить поля "Дата последнего приезда" и 
   "Дата окончания последней визы". Остальные поля необязательны к заполнению.

Список задач для каждого нового приезда:
1. Встреча в аэропорту — дедлайн: "Дата приезда" ИС (берется из приезда)
2. Оплата и заселение в хостел
3. Обмен денег
4. Оформление сим-карты
5. Прохождение медосмотра
6. Перевод паспорта с нотариальным заверением
7. Оформление банковской карты
8. Оформление документов о зачислении
9. Оформление страховки
10. Оформление документов на общежитие
11. Оформление пропуска / студенческого билета
12. Прохождение медосвидетельствования — дедлайн: дата дедлайна для "Продление визы" (поле 13) минус 3 дня. Между 
    датой дедлайна "Прохождение медосвидетельствования" и датой дедлайна "Продление визы" должно быть не менее 
    3 рабочих дней.
13. Продление визы — дедлайн: "Дата окончания последней визы" из профиля ИС минус 40 дней. Если дедлайн 
    выпадает на выходной день или праздник, то дата дедлайна уменьшается до ближайшего рабочего дня. "Дата 
    окончания визы" устанавливается Сопровождающим вручную в расширенном профиле Студента.
14. Прохождение дактилоскопии — дедлайн: "Дата последнего приезда" из профиля ИС плюс 3 месяца.

За 3 дня до наступления дедлайна задач 12-14 Сопровождающему приходит уведомление с соответствующим напоминанием.

Поля "Прохождение медосвидетельствования", "Продление визы", "Прохождение дактилоскопии" 
не имеют дедлайна, если соответственно в полях "Продление визы", "Дата окончания последней 
визы", "Дата последнего приезда" не содержится даты, необходимой для вычисления даты этого поля.

### 2.4.3. Все приезды
Каждый приезд находится в определенной открываемой вкладке. Приезды отсортированы по дате приезда. 
Приезды с бóльшей датой расположены ниже, с меньшей — выше. Экран скролится вверх, а не вниз.

Примечание: порядковый номер последнего приезда может быть меньше порядкового номере более ранних приездов.

Отображаемые поля для вкладки "Приезд" (превью информации о приезде):
1. Порядковый номер приезда
2. Дата приезда
3. Полные имена всех Студентов приезда — в этом поле отображается до 3 полных имен Студентов группы. Если 
   группа содержит более 3 человек, остальные имена не отображаются, вместо них на экране многоточие (иначе 
   для приездов из 5 человек, у каждого из которых по 4 слова в имени, вкладка была бы очень широкой).
4. Страны всех Студентов приезда — содержит название страны и флаг справа от названия. Аналогично с п.3: если в 
   приезде несколько Студентов и у них различаются страны, поле расширяется до 3 строк, отображаются 3 самые 
   популярные страны́ приезда (которых больше всего в приезде). Если стран > 3, остальные не отображаются, 
   четвертой строкой пишется многоточие.
5. Количество сопровождающих — отображается сколько сопровождающих взяли приезд из максимального числа 
   сопровождающих, например: 0/1, 1/1, 1/2, 2/2 и т.д. Если приезд имеет 3 или больше участников, то количество 
   сопровождающих на этот приезд увеличивается до 2.

Тап по вкладке открывает экран 2.4.3.1. "Приезд".

На экране отображается 1 toggle — "Мои приезды":
1. toggle "Мои приезды" — отображает только приезды, которые взял Сопровождающий.

#### 2.4.3.1. Приезд
Этот экран аналогичен экрану 2.3.2.2. "Регистрация приезда", который заполнял ИС, когда отправлял информацию о 
приезде в систему.

Если у приезда несколько человек, _то либо удлиняется экран 2.4.3.1. "Приезд", либо отображается 
дополнительный экран для каждого участника приезда_ с заполненными организатором приезда полями.

Если приезд утвержден, внизу экрана, после всех ИС, которые участвуют в приезде, отображаются 
все Сопровождающие, которые будут заниматься их сопровождением. Для каждого Сопровождающего отдельная вкладка:
0. Фото
1. Полное имя Сопровождающего

Тап по вкладке открывает профиль этого Сопровождающего.

Если пользователь является Сопровождающим или Тимлидером и, если еще не набрано максимальное количество 
сопровождающих для этого приезда, то для него отображается 1 кнопка — "Записаться на этот 
приезд":
1. Кнопка Записаться на этот приезд" —  позволяет пользователю записаться на этот приезд. Кнопка доступна, 
   только если ещё не набрано максимальное количество сопровождающих для этого приезда. Студенты, которые 
   находятся в этом приезде, заносятся на экран 2.4.4. "Студенты Сопровождающего" как Студенты, которых сопровождал 
   этот Сопровождающий. 2.4.2. "Список задач" Сопровождающего обновляется, соответственно с датой этого 
   приезда. После 
   нажатия на кнопку:
   1. отображается popup с надписью: "You have successfully sign up to this arrival. Wait for Teamleader 
      confirmation."
   2. количество сопровождающих в поле 5 вкладки "Приезд" экрана 2.4.3. "Все приезды" увеличивается на 1
   3. открывается экран обновленный 2.4.3.1. "Приезд" для этого приезда.

Если пользователь является Тимлидером, то для него отображаются 2 кнопки — "Удалить сопровождающего из приезда" 
и "Утвердить этот приезд":
1. Кнопка "Удалить сопровождающего из приезда" — кнопка отображается рядом с вкладкой каждого 
   Сопровождающего, который записался на приезд. Если сопровождающий взял приезд по ошибке или желает отказаться от 
   него до того, как он был утвержден, связавшись с Тимлидером он может попросить его об этом. Тимлидер по 
   своему усмотрению убирает его из приезда. 
2. Кнопка "Утвердить этот приезд" — если на приезд набралось достаточное количество Сопровождающих, 
   состав удовлетворяет Тимлидера, он имеет возможность утвердить приезд. После утверждения приезда 
   Сопровождающим автоматически приходит сообщение от Тимлидера, что он утвердил их приезд. ИС автоматически 
   приходит сообщение от Сопровождающих о том, что они получили их приезд и будут их сопровождать.

### 2.4.4. Студенты Сопровождающего
Содержит вкладки со всеми Студентами, сопровождением которых занимался, занимается или будет 
заниматься Сопровождающий. Отображаемые поля вкладки "Студент":
1. Порядковый номер приезда — порядковый номер приезда, в котором Сопровождающий выбрал сопровождать 
   этого Студента.
2. Фото — фото Студента, если нет, то отображается заглушка.
3. Полное имя Студента
4. Гражданство Студента — справа от названия страны гражданства также отображается флаг этой страны.

Тап по вкладке открывает профиль этого ИС.

### 2.4.5. Мессенджер
см. экран 2.3.5. "Мессенджер"

## 2.5. Экраны и функционал для Тимлидера
Тимлидер имеет аналогичные Сопровождающему экраны и функционал. Для некоторых экранов он имеет расширенный 
функционал, о чем написано в описании этих экранов.

см. п. 2.4. "Экраны и функционал для Сопровождающего (Сопровождающего, Бадди)"
